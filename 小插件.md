#              各种好用小插件

### 1.lodash

Lodash 是一个一致性、模块化、高性能的 JavaScript 实用工具库。

里面有各种函数  debounced（防抖动），节流等 函数

安装使用

```
$ npm i --save lodash
```

```
// lodash 支持按需加载，有利于打包结果优化
import { debounce } from "lodash"
```

```js
// debounce 函数
// 参数1：函数
// 参数2：防抖时间
// 返回值：防抖之后的函数，和参数1功能是一样的
onSearchInput: debounce(async function () {
  const searchContent = this.searchContent
  if (!searchContent) {
    return
  }

  // 1. 请求获取数据
  const { data } = await getSuggestions(searchContent)

  // 2. 将数据添加到组件实例中
  this.suggestions = data.data.options

  // 3. 模板绑定
}, 200),
```

### 2.dayjs

用来处理时间的函数

可以显示‘几天前，几分钟前’等格式

安装

```
npm i dayjs --save
```

使用

封装 dayjs.js文件

```js
import Vue from 'vue'
import dayjs from 'dayjs'

// 加载中文语言包
import 'dayjs/locale/zh-cn'

import relativeTime from 'dayjs/plugin/relativeTime'

// 配置使用处理相对时间的插件
dayjs.extend(relativeTime)

// 配置使用中文语言包
dayjs.locale('zh-cn')

// 全局过滤器：处理相对时间
Vue.filter('relativeTime', value => {
    return dayjs().from(dayjs(value))
})
```

组件中使用

```
<script>
import dayjs from '@/utils/dayjs'
</script>


<span>{{ '时间' |relativeTime }}</span>

```

### 3.json-bigint

作用：

处理大数字问题

- js里面的整数有安全范围，即最大能显示的范围，超过了这个范围可能会精度丢失

安装

```
npm i json-bigint
```

使用：放在axios请求文件中

```js
//导入
import JSONbig from 'json-bigint'

//可以通过axios的transformResponse方法，这个方法的作用是在传递给then/catch前，允许修改响应数据

//axios在这里默认把响应体从json字符串转成了js对象
axios.defaults.transformResponse = [function (data) {
console.log(data)//这里的data是字符串，在这个字符串的是没有丢失精度的，所以需要在这里先把精度调好

	try {
	//作用1：把json字符串转为js对象
	//作用2：把里面的大数字做安全处理
	 return JSONbig.parse(data)
	}catch(err){
        console.log(err)
	return data;
	}
	//return data;
}]

//如果不写这个方法，返回的数据是自动就转为json对象的了，如果写了，就要自己转为对象，即return JSON.parse(data)

```

### 4.github-markdown-css

作用：

markdown文案格式优化，使文章的内容以GitHub格式显示

使用场景：

调用文章详情内容时

安装：

```
npm install github-markdown-css
```

使用：

导入`github-markdown.css文件`

```
import 'github-markdown-css/github-markdown.css'
```

添加：`markdown-body的`class即可

```html
 <div class="article-conten markdown-body">
            <p>
              <!-- {{article.content}} -->
            </p>
            </div>
```

### 5.cropper.js

功能：原生JS图片裁剪功能，

可以在图片上传中使用

安装

```
npm install cropperjs
```

使用

1，导入

```
import 'cropperjs/dist/cropper.css';
import Cropper from 'cropperjs';
```

2.页面

```
<div>
  <img id="image" src="picture.jpg">
</div>
```

```
img {
  max-width: 100%; /* This rule is very important, please do not ignore this! */
}
```

3.完成打印

```js
const image = document.getElementById('image');
const cropper = new Cropper(image, {
  aspectRatio: 16 / 9,
  crop(event) {
    console.log(event.detail.x);
    console.log(event.detail.y);
    console.log(event.detail.width);
    console.log(event.detail.height);
    console.log(event.detail.rotate);
    console.log(event.detail.scaleX);
    console.log(event.detail.scaleY);
  },
  console.log(cropper)
});

```

图片裁剪框参数（用于用于头像上传）

```js
const cropper = new Cropper(image, {
        viewMode:1,
        dragMode:'move',
        aspectRatio:1,
        cropBoxMovable:false,
        cropBoxResizable:false,
        background:false,
        movable:true
});
```



获取裁剪过的图片对象，并上传

```js
cropper.getCroppedCanvas().toBlob((blob) => {
  const formData = new FormData();
   //blob为图片对象
  formData.append('croppedImage', blob);

  // Use `jQuery.ajax` method
  $.ajax('/path/to/upload', {
    method: "POST",
    data: formData,
    processData: false,
    contentType: false,
    success() {
      console.log('Upload success');
    },
    error() {
      console.log('Upload error');
    },
  });
});
```

